<?xml version="1.0" encoding="UTF-8"?>

<test name="HTTP regression tests">

    <parameter name="[speedTrans]" operation="set" value="10000" description="number of transaction per second"   		editable="true"/>	
    <parameter name="[TestDurationSec]" operation="set" value="360000" description="Duration (in sec.) of the test"   	    	editable="true"/>
    <parameter name="[NumberTestcase]" operation="set" value="10" description="number of testcase"   			        editable="true"/>
    <parameter name="[ContentSize]" operation="set" value="10000" description="size of the HTTP message"   			editable="true"/>
    
    <!--
       - URL of the HTTP server.
     -->
    <parameter name="[remoteHostHTTP]" operation="system.ipaddress"/>
    <parameter name="[remoteHostHTTP]" operation="set" value="[Remote-Host(0)]"/>
    <parameter name="[remotePortHTTP]" operation="set" value="8080"/>
    <parameter name="[Remote-URL]" operation="set" value="http://[remoteHostHTTP]:[remotePortHTTP]" />

    <parameter name="[speedTestcase]" operation="divide" value="[speedTrans]" value2="[NumberTestcase]"/>	    

    <parameter name="[iter]" operation="number.divide" value="[ContentSize]" value2="10"/>
    <parameter name="[content]" operation="set" value="0123465789" value2="[iter]"/>

    <!--
       - local host and port for HTTP client
     -->
    <parameter name="[localHostHTTP]" operation="system.ipaddress"/>
    <parameter name="[localHostHTTP]" operation="set" value="[Local-Host(0)]"/>
    <parameter name="[localPortHTTP]" operation="set" value="10000"/>

    <!--
       - Scenario of the server.
       - This server will always answer 200 OK.
       - It never ends since it is in a <while> operation.
       -->
    <testcase name="server" description="test post" state="false">
        <scenario name="server">server.xml</scenario>
    </testcase>
    

    <for index="[i]" from="0" to="[NumberTestcase]">        
            <testcase name="client_[i]" description="test post" state="true">
            <parameter name="[destScenario]" operation="set" value="server_[i]" />

            <!--                       -->
            <!-- RUNPROFILE PARAMETERS -->
            <!--                       -->    
            <runProfile>
                <step time="0" frequency="[speedTestcase]"/>
                <end delay="[TestDurationSec]"/>
            </runProfile>

            <scenario name="server_[i]">server.xml</scenario>
            <scenario name="client_[i]">client.xml</scenario>
        </testcase>
    </for>

</test>
