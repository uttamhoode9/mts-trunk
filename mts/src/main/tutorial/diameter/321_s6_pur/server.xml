<?xml version="1.0" encoding="UTF-8"?>
<!-- Related XMLSchema file: conf/schemas/scenario.xsd -->
<!-- name="3GPP S6 Purge UE (PUR/PUA)" -->
<scenario>

<!--
From 3GPP TS 29.272 V9.1.0 : PUR from MME/GGSN to HSS to indicate that the subscriber's profile has been deleted 
from the MME or SGSN either by an MMI interaction or automatically, e.g. because the UE has been inactive for 
several days
Purge-UE-Answer ::= < Diameter Header: 321, PXY, 16777251 >
                                  < Session-Id >
                                  { Vendor-Specific-Application-Id }
                                    Vendor-Specific-Application-Id ::= < AVP Header: 260 >
                                                                         1* [ Vendor-Id ]
                                                                         0*1{ Auth-Application-Id }
                                                                         0*1{ Acct-Application-Id }
                                  [ Result-Code ]
                                  [ Experimental-Result ]
                                    Experimental-Result ::= < AVP Header: 297 >
                                                              { Vendor-Id }
                                                              { Experimental-Result-Code }
                                  [ Error-Diagnostic ]
                                  { Auth-Session-State }
                                  { Origin-Host }
                                  { Origin-Realm }
                                  [ PUA-Flags ]
                                 *[ AVP ]
                                 *[ Failed-AVP ]
                                 *[ Proxy-Info ]
                                    Proxy-Info ::= < AVP Header: 284 >
                                                       { Proxy-Host }
                                                       { Proxy-State }
                                                     * [ AVP ]
                                 *[ Route-Record ]

-->

    <receiveMessageDIAMETER name="ReceiveRequestPUR" request="true" type="3GPP-Purge-UE">
        <parameter name="[commandCode]" operation="protocol.setFromMessage" value="header.command"/>
        <parameter name="[applicationId]" operation="protocol.setFromMessage" value="header.applicationId"/>
    	<parameter name="[hopByHop]" operation="protocol.setFromMessage" value="header.hopByHop"/>
    	<parameter name="[endToEnd]" operation="protocol.setFromMessage" value="header.endToEnd"/>		
    	<parameter name="[sessionId]" operation="protocol.setFromMessage" value="avp.Session-Id.value"/>		
    	<parameter name="[vendorId]" operation="protocol.setFromMessage" value="avp.Vendor-Specific-Application-Id.Vendor-Id.value"/>		
    	<parameter name="[authApplicationId]" operation="protocol.setFromMessage" value="avp.Vendor-Specific-Application-Id.Auth-Application-Id.value"/>		
    	<parameter name="[authSessionState]" operation="protocol.setFromMessage" value="avp.Auth-Session-State.value"/>		
    	<parameter name="[destinationHost]" operation="protocol.setFromMessage" value="avp.Destination-Host.value"/>		
    	<parameter name="[destinationRealm]" operation="protocol.setFromMessage" value="avp.Destination-Realm.value"/>		
    </receiveMessageDIAMETER>
    

	<!-- 
		PUA-Flags : bitmask - 3GPP TS 29.272
			Freeze M-TMSI (bit 0): indicates to MME that M-TMSI shall not be immediately re-used
			Freeze P-TMSI (bit 1): indicates to SGSN that P-TMSI shall not be immediately re-used
	-->
    <parameter name="[PUA-Flags]" operation="set" value="1"/>

    <sendMessageDIAMETER name="SendAnswerPUA">
	<header request="false" command="[commandCode]" applicationId="[applicationId]" proxiable="true" hopByHop="[hopByHop]" endToEnd="[endToEnd]"/>
	<avp code="Session-Id" value="[sessionId]"/>
	<avp code="Vendor-Specific-Application-Id">
		<avp code="Vendor-Id" value="[vendorId]"/>
		<avp code="Auth-Application-Id" value="[authApplicationId]"/>
	</avp>
	<avp code="Result-Code" value="DIAMETER_SUCCESS"/>
	<avp code="Auth-Session-State" value="[authSessionState]"/>
	<avp code="Origin-Host" value="[destinationHost]"/>
	<avp code="Origin-Realm" value="[destinationRealm]"/>
	<avp code="PUA-Flags" value="[PUA-Flags]"/>
    </sendMessageDIAMETER>

</scenario>
