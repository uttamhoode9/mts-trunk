<?xml version="1.0" encoding="UTF-8"?>

<!-- scenario client-->
<scenario>
    
    <parameter name="[connection]" operation="set" value="connection" />

    <openChannelGTP name="[connection]" remoteHost="[serverRemoteIp(0)]" remotePort="[serverRemotePort]"/>

    <sendMessageGTP name="send data record transfer request" channel="[connection]">
        <headerPrime type="240" sequenceNumber="1"/>
        <tlv name="packetTransferCommand" value="16"/>
        <tlv name="dataRecordPacket">
            <attribute name="numberOfDataRecords" value="2"/>
            <attribute name="dataRecordFormat" value="1"/>
            <attribute name="dataRecordFormatVersion" value="65"/>
            <attribute name="dataRecords">
                <attribute name="lengthOfDataRecord" value="16"/>
                <attribute name="dataRecord" value="ceci est un test"/>
                <attribute name="lengthOfDataRecord" value="11"/>
                <attribute name="dataRecord" value="second test"/>
            </attribute>
        </tlv>
    </sendMessageGTP>

    <receiveMessageGTP name="receive data record transfer response">
        <parameter name="[channel]" operation="protocol.setFromMessage" value="channel.name"/>
        <parameter name="[seqNum]" operation="protocol.setFromMessage" value="header.sequenceNumber"/>
        <parameter name="[binary]" operation="protocol.setFromMessage" value="message.binary"/>  
    </receiveMessageGTP>
    
    <test parameter="[binary]" condition="binary.equals" value="0ff1000700010101fd0002000a"/>
    
    <sendMessageGTP name="send data record transfer request" channel="[connection]">
        <headerPrime type="240" sequenceNumber="1"/>
        <tlv name="packetTransferCommand" value="10"/>
        <tlv name="sequenceNumberOfReleasedPackets">
            <attribute name="sequenceNumber" value="2"/>
            <attribute name="sequenceNumber" value="5"/>
            <attribute name="sequenceNumber" value="9"/>
        </tlv>
    </sendMessageGTP>

    <receiveMessageGTP name="receive data record transfer response">
        <parameter name="[channel]" operation="protocol.setFromMessage" value="channel.name"/>
        <parameter name="[seqNum]" operation="protocol.setFromMessage" value="header.sequenceNumber"/>
        <parameter name="[binary]" operation="protocol.setFromMessage" value="message.binary"/>  
    </receiveMessageGTP>
    
    <test parameter="[binary]" condition="binary.equals" value="0ff1000900010102fd00040012012e"/>
    

    <sendMessageGTP name="send data record transfer request" channel="[connection]">
        <headerPrime type="240" sequenceNumber="1"/>
        <tlv name="packetTransferCommand" value="16"/>
        <tlv name="sequenceNumberOfCancelledDataRecords">
            <attribute name="sequenceNumber" value="6"/>
            <attribute name="sequenceNumber" value="1"/>
        </tlv>
    </sendMessageGTP>

    <receiveMessageGTP name="receive data record transfer response">
        <parameter name="[channel]" operation="protocol.setFromMessage" value="channel.name"/>
        <parameter name="[seqNum]" operation="protocol.setFromMessage" value="header.sequenceNumber"/>
        <parameter name="[binary]" operation="protocol.setFromMessage" value="message.binary"/>  
    </receiveMessageGTP>
    
    <test parameter="[binary]" condition="binary.equals" value="0ff1000700010103fd00020001"/>
    

    <finally>
        <closeChannelGTP name="[connection]"/>
    </finally>
    
</scenario>
