<?xml version="1.0" encoding="UTF-8"?>

<!-- scenario server-->
<scenario>

    <createListenpointGTP name="listenpoint" localPort="3387"/>
    
    <parameter name="[testcase:sem1]" operation="system.semaphorenotify" />

    <receiveMessageGTP name="echo request">
        <parameter name="[channel]" operation="protocol.setFromMessage" value="channel.name"/>
        <parameter name="[seqNum]" operation="protocol.setFromMessage" value="header.sequenceNumber"/>
        <parameter name="[tunnelEndpointId]" operation="protocol.setFromMessage" value="header.tunnelEndpointId"/> 
    </receiveMessageGTP>
                                    
    <parameter name="[binary]" operation="protocol.setFromMessage" value="message.binary"/>
    <test parameter="[binary]" condition="binary.equals" value="482000c6000000000000c7000100080002084124002020f94c0006003346452320f94b000800999900000000101156000d001812f430000312f43000000101480008000000c350000186a05300030012f430520001000657000900860000456714150001800001000163000100014f000500010000000047001a00066f7461726965066d6e63303033066d636332313404677072737f000100005d002c004900010005500016004809000000000000000000000000000000000000000057000902840000456f14150001"/>
    
    <sendMessageGTP name="send message" channel="[channel]">
        <headerV2 name="echoResponse" piggyFlag = "0" teidFlag = "1" tunnelEndpointId = "[tunnelEndpointId]" sequenceNumber="[seqNum]"/>
        <element identifier="Recovery" coding="TLIV">
            <field name="Recovery" value="23"/>
        </element>
    </sendMessageGTP>

    <finally>
        <removeListenpointGTP name="listenpoint"/>
    </finally>
</scenario>
