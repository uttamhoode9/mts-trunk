<?xml version="1.0" encoding="ISO-8859-2" ?>
<template>
<parameter name="[search_in]" operation="setFromMessage" value="message" state="{xpath:./ereg[@search_in = 'msg']/@search_in}"/>
<parameter name="[search_in]" operation="set" value="{xpath:./ereg/@variable}" state="{xpath:./ereg[@search_in = 'var']/@search_in}"/>
<parameter name="[search_in]" operation="setFromMessage" value="header.{xpath:./ereg/@header}" state="{xpath:./ereg[@search_in = 'hdr' and @start_line != 'true']/@search_in}"/>
<parameter name="[search_in]" operation="setFromMessage" value="firstline" state="{xpath:./ereg[@search_in = 'hdr' and @start_line = 'true']/@search_in}" />
<parameter name="[search_in]" operation="setFromMessage" value="content" state="{xpath:./ereg[@search_in = 'body']/@search_in}" />
<parameter name="{xpath:./ereg/@assign_to}" operation="string.matches" value="[search_in]" value2="{xpath:./ereg/@regexp}" />
<parameter name="[result]" operation="set" value="{xpath:./ereg/@assign_to}" />
<test parameter="[result]" condition="list.isempty" state="{xpath:./ereg[@check_it = 'true']/@check_it}" />
<test parameter="[result]" condition="list.isempty" not="true" state="{xpath:./ereg[@check_it_inverse = 'true']/@check_it_inverse}"/>
</template>