<?xml version="1.0" encoding="UTF-8"?>
<!-- Related XMLSchema file: conf/schemas/scenario.xsd -->



<!DOCTYPE library [
<!ENTITY libC_Call_Service_Server	SYSTEM "../library/libC_Call_Service_Server.xml">
<!ENTITY libC_Caller_to_Called_Ph1	SYSTEM "../library/libC_Caller_to_Called_Ph1.xml">
<!ENTITY libC_Caller_to_Called_Ph2	SYSTEM "../library/libC_Caller_to_Called_Ph2.xml">
<!ENTITY libC_Caller_to_Called_Ph3	SYSTEM "../library/libC_Caller_to_Called_Ph3.xml">
<!ENTITY libS_Subscriber_Response_Simulator_Ph1		SYSTEM "../library/libS_Subscriber_Response_Simulator_Ph1.xml">
<!ENTITY libS_Subscriber_Response_Simulator_Ph2		SYSTEM "../library/libS_Subscriber_Response_Simulator_Ph2.xml">
<!ENTITY libS_Subscriber_Response_Simulator_Ph3		SYSTEM "../library/libS_Subscriber_Response_Simulator_Ph3.xml">
]>


<scenario>


<parameter name="[sbcPort]" operation="set" value="[SBC_Port_1000]" description="Port decoute du SBC"/>   

<parameter name="[provider_Name]" operation="set" value="[scenarioName]"/>
<parameter name="[provider_Port]" operation="set" value="[Provider_1000]"/>

<openProviderSIP name="open SIP provider" providerName="[provider_Name]" localPort="[provider_Port]"/>


<!-- Test that Call from subscriber_1001 is not received by subscriber_1000
-->

<parameter name="[message_received]" operation="set" value="false"/>

<!--
SWESWE: modification rallongement tempo CANCEL test 3_4_3 sur TOKAY
-->
<parameter name="[Wait_Duration]" operation="setFromConfig" value="sip.properties" value2="SIP_RECEIVE_TIMEOUT_VALUE"/>

<if>
<condition>
<test parameter="[3_5_3_Rallonge_CANCEL_Tempo_only_for_TOKAY]" condition="exists" />
<test parameter="[3_5_3_CANCEL_Tempo_Value_rallongee]" condition="exists" />	  		  		    		  		  	
</condition>
<then>
<parameter name="[Wait_Duration]" operation="set" value="[3_5_3_CANCEL_Tempo_Value_rallongee]"/>
</then></if>

<receiveRequestSIP name="Wait INVITE" method="INVITE" failedOnTimeout="false" timeout="[Wait_Duration]">
	<parameter name="[message_received]" operation="set" value="true"/> 		
</receiveRequestSIP>

<if>
    <condition>
      <test parameter="[message_received]" condition="equals" value="true" />
    </condition>
<then>
<log level="3"> Call has not been barred since Invite has been received => exit with error</log>
<exit name="Call has not been barred since Invite has been received" failed="true"/>
</then>
<else>
</else></if>


<finally><closeProviderSIP name="close SIP provider" providerName="[provider_Name]"/></finally>

</scenario>
