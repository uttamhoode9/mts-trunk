<?xml version="1.0" encoding="UTF-8"?>

<!-- scenario server-->
<scenario>

    <createListenpointGTP name="listenpoint" localPort="3387"/>
    
    <parameter name="[testcase:sem1]" operation="system.semaphorenotify" />

    <receiveMessageGTP name="echo request">
        <parameter name="[channel]" operation="protocol.setFromMessage" value="channel.name"/>
        <parameter name="[seqNum]" operation="protocol.setFromMessage" value="header.sequenceNumber"/>
        <parameter name="[tunnelEndpointId]" operation="protocol.setFromMessage" value="header.tunnelEndpointId"/> 
    </receiveMessageGTP>
                                    
    <parameter name="[binary]" operation="protocol.setFromMessage" value="message.binary"/>
    <!--test parameter="[binary]" condition="binary.equals" value="482000fa0000000056b602000100080002084124002076f04c0006003396992076f04b000800004420429121811056000d001802f810006602f810000067845300030002f8105200010006570009008695962002ac14462a47001d00096e697336636f657063066d6e63303031066d63633230380467707273800001000063000100014f00050001000000004d0003000018007f00010000480008000000c350000186a04e001a008080211001000010810600000000830600000000000d00000a005d002c004900010005570009028480002002ac14462a50001600040700000000000000000000000000000000000000007200020040005f0002000800"/-->
    
    <sendMessageGTP name="send message" channel="[channel]">
        <headerV2 name="echoResponse" piggyFlag = "0" teidFlag = "1" tunnelEndpointId = "[tunnelEndpointId]" sequenceNumber="[seqNum]"/>
        <element identifier="Recovery" coding="TLIV">
            <field name="Recovery" value="23"/>
        </element>
    </sendMessageGTP>

    <finally>
        <removeListenpointGTP name="listenpoint"/>
    </finally>
</scenario>
