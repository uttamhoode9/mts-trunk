<?xml version="1.0" encoding="UTF-8"?>

<scenario>

    <parameter name="[messageEAP]" operation="set">
<![CDATA[
<binary>
<element name="MessageEAP" coding="Message" description="">
    <!-- Header => IETF RFC 3748 chapter 8.1 page 45 -->
    <element name="Header" coding="V" description="">
      <field name="Code" value="Response:2" type="EnumLong" length="1" description=""/>          
      <field name="Id" value="1" length="1" type="Integer" description=""/>            
      <field name="length" value="0" length="2" type="Integer" description=""/>
      <field name="Type" value="Identity:1" length="1" type="EnumLong" description=""/>          
    </element>
    <!-- Attribute Identity:1 => IETF RFC 3748 chapter 5.1 page 18 -->               
    <element tag="Identity:1" coding="V" description="">
        <field name="Identity" value="0208014469111223@nai.epc.mnc001.mcc208.3gppnetwork.org" type="String" description=""/>
    </element>
</element>      
</binary>        
]]>
</parameter>
    <parameter name="[binaryEAP]" operation="binary.fromxml" value="[messageEAP]" value2="eap/dictionary_EAP.xml"/>
    <test parameter="[binaryEAP]" condition="binary.equals" value="0201003b0130323038303134343639313131323233406e61692e6570632e6d6e633030312e6d63633230382e336770706e6574776f726b2e6f7267"/>


    <parameter name="[messageEAP]" operation="set">
<![CDATA[
<binary>
<element name="MessageEAP" coding="Message" description="">
    <!-- Header => IETF RFC 4187 chapter 8.1 page 45 -->
    <element name="Header" coding="V" description="">
      <field name="Code" value="Request:1" type="EnumLong" length="1" description=""/>          
      <field name="Id" value="2" length="1" type="Integer" description=""/>            
      <field name="length" value="0" length="2" type="Integer" description=""/>
      <field name="Type" value="UMTS Authentication and Key Agreement EAP:23" length="1" type="EnumLong" description=""/>          
      <field name="EAP AKA Subtype" value="AKA-Challenge:1" length="1" type="EnumLong" description=""/>                      
      <field name="EAP AKA Reserved" value="0" length="2" type="Integer" description=""/>
    </element>
    <!-- Attribute AT_RAND:1 => IETF RFC 4187 chapter 10.6 page 55 -->               
    <element tag="AT_RAND:1" coding="EAP" description="">
        <field name="Reserved" value="0000" type="Binary" description=""/>
        <field name="AT_RAND" value="027f6f8909616c3ca4c836a02f7642be" type="Binary" description=""/>
    </element>
    <!-- Attribute AT_AUTH:2 => IETF RFC 4187 chapter 10.7 page 56 -->
    <element tag="AT_AUTH:2" coding="EAP" description="">
        <field name="Reserved" value="0000" type="Binary" description=""/>
        <field name="AT_AUTH" value="598451caa6ce0000a52ffc02ec24118b" type="Binary" description=""/>
    </element>
    <!-- Attribute AT_MAC:11 => IETF RFC 4187 chapter 10.15 page 63 -->
    <element tag="AT_MAC:11" coding="EAP" description="">
        <field name="Reserved" value="0000" type="Binary" description=""/>
        <field name="AT_MAC" value="beafd710332dd3c27033c241bcb07053" type="Binary" description=""/>
    </element>
    <!-- Attribute AT_CHECKCODE:134 => IETF RFC 4187 chapter 10.13 page 60 -->
    <element tag="AT_CHECKCODE:134" coding="EAP" description="">
        <field name="Reserved" value="0000" type="Binary" description=""/>
    </element>
    <!-- Attribute AT_IV:129 => IETF RFC 4187 chapter 10.12 page 58 -->
    <element tag="AT_IV:129" coding="EAP" description="">
        <field name="Reserved" value="0000" type="Binary" description=""/>
        <field name="AT_IV" value="fba14079d7d0e05175eb39c560be666c" type="Binary" description=""/>
    </element>
    <!-- AT_ENCR_DATA:130 => IETF RFC 4187 chapter 10.12 page 58 -->
    <element tag="AT_ENCR_DATA:130" coding="EAP" description="">
        <field name="Reserved" value="0000" type="Binary" description=""/>
        <field name="AT_IV" value="dbdb27475b908288f989747ff01e9247a4ff1d07cf81da16e220c0a64247f01e314781278cae2683e93f7cd033a9ee2877ccea2d492e244c4dc4657528b8fc8209d7391bd0806b913dfedbb10e050b58a041578708fe8efc760374949320bd26" type="Binary" description=""/>
    </element>
</element>      
</binary>        
]]>
</parameter>
    <parameter name="[binaryEAP]" operation="binary.fromxml" value="[messageEAP]" value2="eap/dictionary_EAP.xml"/>
    <test parameter="[binaryEAP]" condition="binary.equals" value="010200c01701000001050000027f6f8909616c3ca4c836a02f7642be02050000598451caa6ce0000a52ffc02ec24118b0b050000beafd710332dd3c27033c241bcb070538601000081050000fba14079d7d0e05175eb39c560be666c82190000dbdb27475b908288f989747ff01e9247a4ff1d07cf81da16e220c0a64247f01e314781278cae2683e93f7cd033a9ee2877ccea2d492e244c4dc4657528b8fc8209d7391bd0806b913dfedbb10e050b58a041578708fe8efc760374949320bd26"/>

    <parameter name="[messageEAP]" operation="set">
<![CDATA[
<binary>
<element name="MessageEAP" coding="Message" description="">
    <!-- Header => IETF RFC 4187 chapter 8.1 page 45 -->
    <element name="Header" coding="V" description="">
      <field name="Code" value="Response:2" type="EnumLong" length="1" description=""/>          
      <field name="Id" value="2" length="1" type="Integer" description=""/>            
      <field name="Length" value="0" length="2" type="Integer" description=""/>
      <field name="Type" value="UMTS Authentication and Key Agreement EAP:23" length="1" type="EnumLong" description=""/>          
      <field name="EAP AKA Subtype" value="AKA-Challenge:1" length="1" type="EnumLong" description=""/>                      
      <field name="EAP AKA Reserved" value="0" length="2" type="Integer" description=""/>
    </element>
    <!-- Attribute AT_MAC:11 => IETF RFC 4187 chapter 10.15 page 63 -->
    <element tag="AT_MAC:11" coding="EAP" description="">
        <field name="Reserved" value="0000" type="Binary" description=""/>
        <field name="AT_MAC" value="b70f5d335df7606d83b4c87d820e6071" type="Binary" description=""/>
    </element>
    <!-- Attribute AT_RES:3 => IETF RFC 4187 chapter 10.8 page 56 -->
    <element tag="AT_RES:3" coding="EAP" description="">
        <field name="Reserved" value="0040" type="Binary" description=""/>
        <field name="AT_MAC" value="39bcb97622c4715a" type="Binary" description=""/>        
    </element>
</element>      
</binary>        
]]>
</parameter>
    <parameter name="[binaryEAP]" operation="binary.fromxml" value="[messageEAP]" value2="eap/dictionary_EAP.xml"/>
    <test parameter="[binaryEAP]" condition="binary.equals" value="02020028170100000b050000b70f5d335df7606d83b4c87d820e60710303004039bcb97622c4715a"/>

        <parameter name="[messageEAP]" operation="set">
<![CDATA[
<binary>
<element name="MessageEAP" coding="Message" description="">
    <!-- Header => IETF RFC 4187 chapter 8.1 page 45 -->
    <element name="Header" coding="V" description="">
      <field name="Code" value="Success:3" type="EnumLong" length="1" description=""/>          
      <field name="Id" value="1" length="1" type="Integer" description=""/>            
      <field name="Length" value="0" length="2" type="Integer" description=""/>
    </element>
</element>      
</binary>        
]]>
</parameter>
    <parameter name="[binaryEAP]" operation="binary.fromxml" value="[messageEAP]" value2="eap/dictionary_EAP.xml"/>
    <test parameter="[binaryEAP]" condition="binary.equals" value="03010004"/>

                  
</scenario>
