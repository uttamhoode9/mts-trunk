<?xml version="1.0" encoding="UTF-8"?>

<scenario>

    <createListenpointSCTP name="listenpoint2" localHost="164.48.84.98" localPort="5665"/>

    <openChannelSCTP name="channel" localHost="[localHostSCTP],164.48.84.92" localPort="[localPortSCTP]" remoteHost="[remoteHostSCTP],164.48.84.92" remotePort="5665"/>
    
    <receiveMessageSCTP request="true" type="INIT-ACK" timeout="5"/>

    <sendMessageSCTP channel="channel">
        <data format="binary">h41:1 h441:1 b01000001:1 d0000065:1 65</data>
    </sendMessageSCTP>
     
   <receiveMessageSCTP request="true" type="DATA" timeout="5">
	<parameter name="[lastChannel]" operation="protocol.setFromMessage" value="channel.name"/>
    </receiveMessageSCTP>

    <parameter name="[lastSourceHost]" operation="protocol.setFromMessage" value="header.sourceHost"/>
    <parameter name="[localHosts]" operation="system.ipaddress" value2="ipv4"/>
    <parameter name="[localHosts]" operation="list.removelast" value="[localHosts]"/>
    <test parameter="[lastSourceHost]" condition="string.equals" value="[localHosts]" />
    <parameter name="[lastSourcePort]" operation="protocol.setFromMessage" value="header.sourcePort"/>
    <test parameter="[lastSourcePort]" condition="string.equals" value="[localPortSCTP]" />
    
    <parameter name="[lastContents]" operation="protocol.setFromMessage" value="data.text" />
    <test parameter="[lastContents]" condition="string.equals" value="AAAAA" />

    <closeChannelSCTP name="[lastChannel]"/>

    <!--createListenpointSCTP name="listenpoint1" localHost="[localHostSCTP]" localPort="5665"/>

    <sendMessageSCTP channel="channel">
        <data format="binary">h41:1 h441:1 b01000001:1 d0000065:1 65</data>
    </sendMessageSCTP>
     
   <receiveMessageSCTP request="true" type="DATA" timeout="5">
    </receiveMessageSCTP-->

    <finally>

        <closeChannelSCTP name="channel"/>
        
        <receiveMessageSCTP request="true" type="ABORT-ACK" timeout="5"/>
	
    </finally>

</scenario>
